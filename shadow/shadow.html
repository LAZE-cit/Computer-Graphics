<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>シェーディングの練習</title>
    <!-- three.jsを読み込む(CDN)-->
    <script src="https://unpkg.com/three@0.137.4/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.137.4/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <script>
        var init = function(){

            var width = 1000, height = 750;

            // レンダラーを作成
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(width,height);
            document.body.appendChild(renderer.domElement);
            renderer.shadowMap.enabled = true;

            // シーンを作成
            var scene = new THREE.Scene();

            // カメラを作成
            var camera = new THREE.PerspectiveCamera(45,width/height,1,1000);
            camera.position.set(30,15,0);
            const controls = new THREE.OrbitControls(camera, document.body);

            //テクスチャー読込
            var textureLoader = new THREE.TextureLoader();
            var texture = textureLoader.load("original.jpg");
            var mat = new THREE.MeshPhongMaterial();
            mat.map = texture;

            /*バンプマップ読込
            var bump = textureLoader.load("original.jpg");
            mat.bumpMap = bump;
            mat.bumpscale = 0.2;*/

            // helper
            const gridHelper = new THREE.GridHelper(2,10); // size, step
            scene.add(gridHelper);
            const axisHelper = new THREE.AxisHelper(20); //軸の長さ X：赤、Y：緑、Z：青
            scene.add(axisHelper);

            //平面の作成
            var geometry = new THREE.PlaneGeometry(30,30,1);
            var material = new THREE.MeshLambertMaterial({color:0xffffff});
            var plane = new THREE.Mesh(geometry,material);
            plane.rotation.x = -(Math.PI/2);
            plane.receiveShadow = true;
            scene.add(plane);

            //箱の作成
            geometry = new THREE.BoxGeometry(3,3,3);
            var box = new THREE.Mesh(geometry,mat);
            box.position.set(-3,3,-3);
            box.castShadow = true;
            scene.add(box);

            //ライトの作成
            var light = new THREE.SpotLight({color:0xffffff});
            light.position.set(15,15,15);
            light.castShadow = true;
            light.shadow.mapSize.width = 2048;
            light.shadow.mapSize.height = 2048;
            scene.add(light);

            //球体の作成
            geometry = new THREE.SphereGeometry(1,32,32)
            material = new THREE.MeshLambertMaterial({color:0xff0000});
            var red = new THREE.Mesh(geometry,material);
            red.position.set(3,3,3);
            red.castShadow = true;
            scene.add(red);

            //初回実行
            var update = function(){
                requestAnimationFrame(update);
                renderer.render(scene,camera);
            }
            update();
        }
        window.addEventListener('DOMContentLoaded',init);
    </script>
</body>